import os
import numpy as np
from PIL import Image
from tqdm import tqdm

def png_to_npy(input_dir, output_dir):
    """
    Converts PNG images in a directory to .npy files.

    Parameters:
    - input_dir: Directory containing the PNG images.
    - output_dir: Directory where .npy files will be saved.
    """
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)

    # List all PNG files in the input directory
    png_files = [f for f in os.listdir(input_dir) if f.endswith('.png')]

    # Process each file
    for file_name in tqdm(png_files, desc="Converting PNG to NPY"):
        # Load the image
        img_path = os.path.join(input_dir, file_name)
        img = Image.open(img_path)
        img_array = np.array(img)

        # Save to .npy file
        output_file_name = os.path.splitext(file_name)[0] + '.npy'
        np.save(os.path.join(output_dir, output_file_name), img_array)

# Example usage
input_dir = '/shared/anastasio-s2/SI/TCVAE/DL_feature_interpretation/dataset_with_resizing/train'  # Change this to your input directory path
output_dir = '/shared/anastasio-s2/SI/TCVAE/DL_feature_interpretation/dataset_with_resizing/train_npy'  # Change this to your desired output directory path

png_to_npy(input_dir, output_dir)
